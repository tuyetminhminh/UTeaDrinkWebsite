<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{fragments/admin-layout :: adminLayout(~{::title}, ~{::content})}">
<head>
  <meta charset="UTF-8">
  <title>üè™ Qu·∫£n l√Ω c·ª≠a h√†ng</title>
</head>
<body>
<div th:fragment="content">

<div th:replace="~{fragments/breadcrumbs ::
  bc('Trang ch·ªß', @{/admin/home},
     null, null,
     'C·ª≠a h√†ng')
}"></div>


  <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>
  <div th:if="${success}" class="alert alert-success" th:text="${success}"></div>

  <div class="d-flex align-items-center justify-content-between mb-3">
    <h3 class="m-0">üè™ Qu·∫£n l√Ω c·ª≠a h√†ng</h3>
    <a class="btn btn-primary"
       th:href="@{/admin/shops/new(page=${pageIndex},size=${size}, q=${q})}">
      <i class="bi bi-plus-circle"></i> Th√™m c·ª≠a h√†ng
    </a>
  </div>

  <div class="table-responsive">
    <table class="table table-striped align-middle">
      <thead>
      <tr>
        <th style="width:70px">#</th>
        <th>T√™n</th>
        <th style="width:160px">ƒêi·ªán tho·∫°i</th>
        <th style="width:120px">Tr·∫°ng th√°i</th>
        <th style="width:220px">Manager</th>
        <th style="width:240px" class="text-end">Thao t√°c</th>
      </tr>
      </thead>
      <tbody>
      <tr th:if="${page==null or #lists.isEmpty(page.content)}">
        <td colspan="6" class="text-center text-muted">Ch∆∞a c√≥ c·ª≠a h√†ng.</td>
      </tr>

      <tr th:each="s, i : ${page.content}">
        <td th:text="${i.index + 1 + (pageIndex-1)*size}"></td>
        <td th:text="${s.name}"></td>
        <td th:text="${s.phone}">-</td>
        <td>
          <span th:if="${s.status == 'OPEN'}"
                class="badge bg-success"
                th:text="${s.status}">OPEN</span>

          <span th:if="${s.status == 'CLOSED'}"
                class="badge bg-secondary"
                th:text="${s.status}">CLOSED</span>

          <span th:if="${s.status != 'OPEN' and s.status != 'CLOSED'}"
                class="badge bg-warning text-dark"
                th:text="${s.status}">MAINTENANCE</span>
        </td> 
                <td>
          <span th:if="${s.tempManagerName != null}" th:text="${s.tempManagerName}"></span>
          <span th:if="${s.tempManagerName == null}" class="text-muted">‚Äî</span>
        </td>

        <td class="text-end">
          <a class="btn btn-sm btn-outline-primary"
             th:href="@{/admin/shops/{id}/edit(id=${s.id}, page=${pageIndex}, size=${size}, q=${q})}">
            S·ª≠a
          </a>
          <form th:action="@{/admin/shops/{id}/delete(id=${s.id})}" method="post"
                class="d-inline" onsubmit="return confirm('X√≥a c·ª≠a h√†ng n√†y?');">
            <input type="hidden" name="page" th:value="${pageIndex}">
            <input type="hidden" name="size" th:value="${size}">
            <button type="submit" class="btn btn-sm btn-outline-danger">X√≥a</button>
          </form>

        </td>
      </tr>
      </tbody>
    </table>
  </div>

  <div class="d-flex flex-wrap align-items-center justify-content-between gap-3 mt-3">

  <!-- Pagination -->
  <nav th:if="${page.totalPages > 1}" aria-label="Page navigation">
    <ul class="pagination mb-0">
      <!-- Prev -->
      <li class="page-item" th:classappend="${pageIndex==1}? 'disabled'">
        <a class="page-link"
           th:href="@{/admin/shops(page=${pageIndex-1}, size=${size}, q=${q})}">¬´</a>
      </li>

      <!-- Numbers -->
      <li class="page-item"
          th:each="i : ${#numbers.sequence(1, page.totalPages)}"
          th:classappend="${i==pageIndex}? 'active'">
        <a class="page-link"
           th:text="${i}"
           th:href="@{/admin/shops(page=${i}, size=${size}, q=${q})}"></a>
      </li>

      <!-- Next -->
      <li class="page-item" th:classappend="${pageIndex==page.totalPages}? 'disabled'">
        <a class="page-link"
           th:href="@{/admin/shops(page=${pageIndex+1}, size=${size}, q=${q})}">¬ª</a>
      </li>
    </ul>
  </nav>

  <!-- Page size selector -->
  <form th:action="@{/admin/shops}" method="get" class="d-flex align-items-center gap-2">
    <input type="hidden" name="q" th:value="${q}">
    <input type="hidden" name="page" value="1">

    <label for="shopPageSize" class="form-label mb-0 text-nowrap">S·ªë d√≤ng/trang:</label>
    <select id="shopPageSize" class="form-select form-select-sm" name="size"
            style="width:auto" onchange="this.form.submit()">
      <option th:each="s : ${sizes}"
              th:value="${s}"
              th:text="${s}"
              th:selected="${s == size}">
      </option>
    </select>
  </form>

</div>


</div>
</body>
</html>
